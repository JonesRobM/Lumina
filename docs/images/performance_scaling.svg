<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 800 500">
  <!-- Background -->
  <rect width="800" height="500" fill="#ffffff"/>

  <!-- Title -->
  <text x="400" y="30" font-family="Arial, sans-serif" font-size="18" font-weight="bold" text-anchor="middle" fill="#333">
    Solver Performance Scaling
  </text>
  <text x="400" y="50" font-family="Arial, sans-serif" font-size="13" text-anchor="middle" fill="#666" font-style="italic">
    Au sphere, single wavelength, Intel i7-12700K @ 3.6GHz
  </text>

  <!-- Plot area -->
  <rect x="100" y="80" width="600" height="340" fill="#f9f9f9" stroke="#ddd" stroke-width="1"/>

  <!-- Grid lines (log scale) -->
  <g stroke="#e0e0e0" stroke-width="0.5">
    <!-- Horizontal grid -->
    <line x1="100" y1="120" x2="700" y2="120"/>
    <line x1="100" y1="160" x2="700" y2="160"/>
    <line x1="100" y1="200" x2="700" y2="200"/>
    <line x1="100" y1="240" x2="700" y2="240"/>
    <line x1="100" y1="280" x2="700" y2="280"/>
    <line x1="100" y1="320" x2="700" y2="320"/>
    <line x1="100" y1="360" x2="700" y2="360"/>
    <line x1="100" y1="400" x2="700" y2="400"/>

    <!-- Vertical grid -->
    <line x1="200" y1="80" x2="200" y2="420"/>
    <line x1="300" y1="80" x2="300" y2="420"/>
    <line x1="400" y1="80" x2="400" y2="420"/>
    <line x1="500" y1="80" x2="500" y2="420"/>
    <line x1="600" y1="80" x2="600" y2="420"/>
  </g>

  <!-- Axes -->
  <line x1="100" y1="420" x2="700" y2="420" stroke="#333" stroke-width="2"/>
  <line x1="100" y1="80" x2="100" y2="420" stroke="#333" stroke-width="2"/>

  <!-- Direct solver (LU) - O(N³) scaling -->
  <path d="M 120,410 L 160,400 L 200,380 L 240,340 L 280,280 L 320,200 L 360,110"
        fill="none" stroke="#e74c3c" stroke-width="3"/>

  <!-- GMRES solver - O(N² log N) scaling -->
  <path d="M 120,410 L 160,405 L 200,395 L 240,380 L 280,360 L 320,335 L 360,310 L 400,285 L 440,260 L 480,240 L 520,220 L 560,202 L 600,185 L 640,170 L 680,155"
        fill="none" stroke="#3498db" stroke-width="3"/>

  <!-- FCD overhead marker -->
  <path d="M 120,412 L 160,408 L 200,400 L 240,388 L 280,370 L 320,348 L 360,325 L 400,302 L 440,280 L 480,262 L 520,245 L 560,230 L 600,215 L 640,202 L 680,190"
        fill="none" stroke="#9b59b6" stroke-width="2.5" stroke-dasharray="5,3"/>

  <!-- Data points for Direct -->
  <g fill="#e74c3c">
    <circle cx="120" cy="410" r="4"/>
    <circle cx="160" cy="400" r="4"/>
    <circle cx="200" cy="380" r="4"/>
    <circle cx="240" cy="340" r="4"/>
    <circle cx="280" cy="280" r="4"/>
    <circle cx="320" cy="200" r="4"/>
    <circle cx="360" cy="110" r="4"/>
  </g>

  <!-- Data points for GMRES -->
  <g fill="#3498db">
    <circle cx="200" cy="395" r="4"/>
    <circle cx="280" cy="360" r="4"/>
    <circle cx="360" cy="310" r="4"/>
    <circle cx="440" cy="260" r="4"/>
    <circle cx="520" cy="220" r="4"/>
    <circle cx="600" cy="185" r="4"/>
    <circle cx="680" cy="155" r="4"/>
  </g>

  <!-- Crossover point annotation -->
  <circle cx="280" cy="280" r="8" fill="none" stroke="#27ae60" stroke-width="2"/>
  <line x1="280" y1="280" x2="280" y2="240" stroke="#27ae60" stroke-width="1.5" stroke-dasharray="3,2"/>
  <text x="280" y="230" font-family="Arial, sans-serif" font-size="11" text-anchor="middle" fill="#27ae60" font-weight="bold">
    N=1000
  </text>
  <text x="280" y="245" font-family="Arial, sans-serif" font-size="10" text-anchor="middle" fill="#27ae60">
    Crossover
  </text>

  <!-- X-axis labels (log scale) -->
  <text x="100" y="440" font-family="Arial, sans-serif" font-size="11" text-anchor="middle" fill="#666">10²</text>
  <text x="200" y="440" font-family="Arial, sans-serif" font-size="11" text-anchor="middle" fill="#666">10³</text>
  <text x="300" y="440" font-family="Arial, sans-serif" font-size="11" text-anchor="middle" fill="#666">2×10³</text>
  <text x="400" y="440" font-family="Arial, sans-serif" font-size="11" text-anchor="middle" fill="#666">5×10³</text>
  <text x="500" y="440" font-family="Arial, sans-serif" font-size="11" text-anchor="middle" fill="#666">10⁴</text>
  <text x="600" y="440" font-family="Arial, sans-serif" font-size="11" text-anchor="middle" fill="#666">2×10⁴</text>
  <text x="700" y="440" font-family="Arial, sans-serif" font-size="11" text-anchor="middle" fill="#666">5×10⁴</text>

  <!-- Y-axis labels (log scale) -->
  <text x="85" y="425" font-family="Arial, sans-serif" font-size="11" text-anchor="end" fill="#666">0.01s</text>
  <text x="85" y="385" font-family="Arial, sans-serif" font-size="11" text-anchor="end" fill="#666">0.1s</text>
  <text x="85" y="345" font-family="Arial, sans-serif" font-size="11" text-anchor="end" fill="#666">1s</text>
  <text x="85" y="305" font-family="Arial, sans-serif" font-size="11" text-anchor="end" fill="#666">10s</text>
  <text x="85" y="265" font-family="Arial, sans-serif" font-size="11" text-anchor="end" fill="#666">1m</text>
  <text x="85" y="225" font-family="Arial, sans-serif" font-size="11" text-anchor="end" fill="#666">10m</text>
  <text x="85" y="185" font-family="Arial, sans-serif" font-size="11" text-anchor="end" fill="#666">1h</text>
  <text x="85" y="145" font-family="Arial, sans-serif" font-size="11" text-anchor="end" fill="#666">10h</text>
  <text x="85" y="105" font-family="Arial, sans-serif" font-size="11" text-anchor="end" fill="#666">100h</text>

  <!-- Axis titles -->
  <text x="400" y="470" font-family="Arial, sans-serif" font-size="14" text-anchor="middle" fill="#333">
    Number of Dipoles (N)
  </text>
  <text x="40" y="250" font-family="Arial, sans-serif" font-size="14" text-anchor="middle" fill="#333"
        transform="rotate(-90 40 250)">
    Computation Time
  </text>

  <!-- Legend -->
  <g transform="translate(520, 100)">
    <rect x="0" y="0" width="160" height="95" fill="white" stroke="#ddd" stroke-width="1" rx="4"/>

    <line x1="10" y1="20" x2="40" y2="20" stroke="#e74c3c" stroke-width="3"/>
    <circle cx="25" cy="20" r="4" fill="#e74c3c"/>
    <text x="50" y="24" font-family="Arial, sans-serif" font-size="11" fill="#333">Direct (LU)</text>

    <line x1="10" y1="45" x2="40" y2="45" stroke="#3498db" stroke-width="3"/>
    <circle cx="25" cy="45" r="4" fill="#3498db"/>
    <text x="50" y="49" font-family="Arial, sans-serif" font-size="11" fill="#333">GMRES(30)</text>

    <line x1="10" y1="70" x2="40" y2="70" stroke="#9b59b6" stroke-width="2.5" stroke-dasharray="5,3"/>
    <text x="50" y="74" font-family="Arial, sans-serif" font-size="11" fill="#333">FCD+GMRES</text>
  </g>

  <!-- Scaling annotations -->
  <g font-family="Arial, sans-serif" font-size="10" font-style="italic" fill="#7f8c8d">
    <text x="340" y="130" transform="rotate(-60 340 130)">O(N³)</text>
    <text x="580" y="180">O(N² log N)</text>
  </g>

  <!-- Performance notes -->
  <g transform="translate(110, 110)" font-family="Arial, sans-serif" font-size="10" fill="#34495e">
    <rect x="0" y="0" width="180" height="75" fill="#ecf0f1" stroke="#bdc3c7" stroke-width="1" rx="3"/>
    <text x="90" y="15" text-anchor="middle" font-weight="bold" font-size="11" fill="#2c3e50">Quick Facts</text>
    <text x="10" y="32">• Direct: Fast for N &lt; 1000</text>
    <text x="10" y="46">• GMRES: Scales to N &gt; 10⁴</text>
    <text x="10" y="60">• FCD: ~15% overhead</text>
    <text x="10" y="74">• Parallel: 12 threads</text>
  </g>

  <!-- Memory note -->
  <g transform="translate(500, 220)">
    <text x="0" y="0" font-family="Arial, sans-serif" font-size="10" fill="#e74c3c">
      <tspan font-weight="bold">Memory:</tspan>
    </text>
    <text x="0" y="14" font-family="Arial, sans-serif" font-size="9" fill="#666">
      Direct: ~10 GB @ N=10⁴
    </text>
    <text x="0" y="26" font-family="Arial, sans-serif" font-size="9" fill="#666">
      GMRES: ~0.5 GB @ N=10⁴
    </text>
  </g>
</svg>
